<mujoco model="dm_arm">
  <!--
    Units & conventions
    - angle="radian": joint ranges are in radians
    - meshdir: relative path where STL meshes are located
    - autolimits="true": MuJoCo derives missing joint limits if possible (we still set range explicitly)
  -->
  <compiler angle="radian" meshdir="../meshes" autolimits="true"/>

  <!-- Simulation settings -->
  <option gravity="0 0 -9.81" timestep="0.001" integrator="RK4"/>

  <!-- Common defaults to reduce repetition -->
  <default>
    <!-- Visual-only mesh: does not participate in collision -->
    <default class="visual_mesh">
      <geom type="mesh" contype="0" conaffinity="0" mass="0" density="0"/>
    </default>

    <!-- Collision mesh: participates in collision, kept transparent -->
    <default class="collision_mesh">
      <geom type="mesh" rgba="0 0 0 0" contype="1" conaffinity="1" mass="0" density="0"/>
    </default>

    <!-- Common hinge joint damping/armature baseline; override per joint as needed -->
    <default class="arm_hinge">
      <joint type="hinge" limited="true" range="-3.14 3.14"/>
    </default>
  </default>

  <asset>
    <!-- Robot meshes (STL). Keep names stable for geom references. -->
    <mesh name="base_link"     file="base_link.STL"/>
    <mesh name="link1"         file="link1.STL"/>
    <mesh name="link2"         file="link2.STL"/>
    <mesh name="link3"         file="link3.STL"/>
    <mesh name="link4"         file="link4.STL"/>
    <mesh name="link5"         file="link5.STL"/>
    <mesh name="link6"         file="link6.STL"/>
    <mesh name="dm_hand"       file="dm_hand.STL"/>
    <mesh name="dm_left_hand"  file="dm_left_hand.STL"/>
    <mesh name="dm_right_hand" file="dm_right_hand.STL"/>
  </asset>

  <worldbody>

    <!-- Base -->
    <body name="base_link" pos="0 0 0.3">
      <inertial pos="0 0 0" mass="2.5" diaginertia="0.020 0.020 0.020"/>

      <geom class="visual_mesh"   mesh="base_link" rgba="0.35 0.35 0.35 1"/>
      <geom class="collision_mesh" name="col_base_link" mesh="base_link"/>

      <!-- Link1 -->
      <body name="link1" pos="0 0 0.065" quat="0.5 0.5 0.5 0.5">
        <inertial pos="0 0 0" mass="1.2" diaginertia="0.010 0.010 0.010"/>

        <joint class="arm_hinge" name="joint1" axis="0 1 0"
               damping="2" armature="0.01"/>

        <geom class="visual_mesh"    mesh="link1" rgba="0.35 0.35 0.35 1"/>
        <geom class="collision_mesh" name="col_link1" mesh="link1"/>

        <!-- Link2 -->
        <body name="link2" pos="0 0.05 0" quat="0.7071067811865462 0 0.7071067811865488 0">
          <inertial pos="0 0 0" mass="1.0" diaginertia="0.008 0.008 0.008"/>

          <joint class="arm_hinge" name="joint2" axis="1 0 0"
                 damping="2" armature="0.01"/>

          <geom class="visual_mesh"    mesh="link2" rgba="0.35 0.35 0.35 1"/>
          <geom class="collision_mesh" name="col_link2" mesh="link2"/>

          <!-- Link3 -->
          <body name="link3" pos="0 0.3 0"
                quat="5.26835673519653e-09 0.7071067811865462 5.268356735196549e-09 -0.7071067811865488">
            <inertial pos="0 0 0" mass="0.8" diaginertia="0.006 0.006 0.006"/>

            <joint class="arm_hinge" name="joint3" axis="0 0 -1"
                   damping="1.5" armature="0.008"/>

            <geom class="visual_mesh"    mesh="link3" rgba="0.35 0.35 0.35 1"/>
            <geom class="collision_mesh" name="col_link3" mesh="link3"/>

            <!-- Link4 -->
            <body name="link4" pos="-0.262 -0.068 0" quat="-3.673205103346574e-06 -0.9999999999932537 0 0">
              <inertial pos="0 0 0" mass="0.6" diaginertia="0.004 0.004 0.004"/>

              <joint class="arm_hinge" name="joint4" axis="-1 0 0"
                     damping="1.0" armature="0.006"/>

              <geom class="visual_mesh"    mesh="link4" rgba="0.35 0.35 0.35 1"/>
              <geom class="collision_mesh" name="col_link4" mesh="link4"/>

              <!-- Link5 -->
              <body name="link5" pos="0 0 0" quat="-3.673205103346574e-06 0 0 0.9999999999932537">
                <inertial pos="0 0 0" mass="0.5" diaginertia="0.003 0.003 0.003"/>

                <joint class="arm_hinge" name="joint5" axis="0 0 1"
                       damping="0.8" armature="0.005"/>

                <geom class="visual_mesh"    mesh="link5" rgba="0.35 0.35 0.35 1"/>
                <geom class="collision_mesh" name="col_link5" mesh="link5"/>

                <!-- Link6 -->
                <body name="link6" pos="0.085 0 -0.002"
                      quat="0.7071067811901252 -1.2986741185772033e-06 0.7071067811805847 -1.2986741186327144e-06">
                  <inertial pos="0 0 0" mass="0.4" diaginertia="0.002 0.002 0.002"/>

                  <joint class="arm_hinge" name="joint6" axis="0 0 1"
                         damping="0.5" armature="0.004"/>

                  <geom class="visual_mesh"    mesh="link6" rgba="0.35 0.35 0.35 1"/>
                  <geom class="collision_mesh" name="col_link6" mesh="link6"/>

                  <!-- Hand base (mount) -->
                  <body name="dm_hand" pos="-0.0775 -0.0045 0.02"
                        quat="0.4999981633974483 0.49999999999662686 0.5000018366025516 0.49999999999662686">
                    <inertial pos="0 0 0" mass="0.3" diaginertia="0.0015 0.0015 0.0015"/>

                    <geom class="visual_mesh"    mesh="dm_hand" rgba="0.6 0.65 0.75 1"/>
                    <geom class="collision_mesh" name="col_dm_hand" mesh="dm_hand"/>

                    <!-- Right jaw -->
                    <body name="dm_right_hand" pos="0.0044 -0.0083 0.059139"
                          quat="1.3492435731251315e-11 3.6732051033217936e-06 -0.9999999999865075 -3.6732051033217936e-06">
                      <inertial pos="0 0 0" mass="0.15" diaginertia="0.0006 0.0006 0.0006"/>

                      <joint name="dm_right_joint" type="slide" axis="0 0 1"
                             limited="true" range="0 0.045" damping="5"/>

                      <geom class="visual_mesh"    mesh="dm_right_hand" rgba="0.35 0.35 0.35 1"/>
                      <geom class="collision_mesh" name="col_dm_right_hand" mesh="dm_right_hand"/>
                    </body>

                    <!-- Left jaw (moves opposite direction via equality constraint) -->
                    <body name="dm_left_hand" pos="0.0044 -0.0083 0.095861">
                      <inertial pos="0 0 0" mass="0.15" diaginertia="0.0006 0.0006 0.0006"/>

                      <joint name="dm_left_joint" type="slide" axis="0 0 -1"
                             limited="true" range="-0.045 0" damping="5"/>

                      <geom class="visual_mesh"    mesh="dm_left_hand" rgba="0.35 0.35 0.35 1"/>
                      <geom class="collision_mesh" name="col_dm_left_hand" mesh="dm_left_hand"/>
                    </body>

                  </body>
                </body>
              </body>
            </body>
          </body>
        </body>
      </body>
    </body>
  </worldbody>

  <!--
    Gripper coupling:
    dm_left_joint = - dm_right_joint (via polynomial equality)
    This ensures symmetric opening/closing with a single actuator if desired.
  -->
  <equality>
    <joint joint1="dm_left_joint" joint2="dm_right_joint" polycoef="0 -1 0 0 0"/>
  </equality>

  <actuator>
    <!-- Arm joints: position actuators (PD-like) -->
    <position name="j1_pos" joint="joint1" kp="600" kv="50" forcerange="-300 300"/>
    <position name="j2_pos" joint="joint2" kp="60"  kv="10"/>
    <position name="j3_pos" joint="joint3" kp="50"  kv="9"/>
    <position name="j4_pos" joint="joint4" kp="40"  kv="8"/>
    <position name="j5_pos" joint="joint5" kp="30"  kv="6"/>
    <position name="j6_pos" joint="joint6" kp="25"  kv="5"/>

    <!-- Gripper: motor drives dm_right_joint; dm_left_joint follows via equality -->
    <motor name="gripper_motor" joint="dm_right_joint" gear="20"/>
  </actuator>
</mujoco>
